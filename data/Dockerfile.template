FROM resin/%%RESIN_MACHINE_NAME%%-alpine-node

# FROM resin/%%RESIN_MACHINE_NAME%%-node
# RUN apt-get update && apt-get install -yq python-dbus python-sense-hat && \
#     apt-get clean && rm -rf /var/lib/apt/lists/*

WORKDIR /usr/src/app

COPY package.json package.json
RUN apk add --no-cache --virtual .gyp \
        python \
        make \
        g++ \
    && npm install --production --unsafe-perm \
    && apk del .gyp

RUN JOBS=MAX npm install --production
COPY . ./

CMD ["npm", "start"]
